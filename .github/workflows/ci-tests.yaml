name: CI-Tests
on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - dev

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    container:
      image: google/dart:latest
    env:
      AUTH_TOKEN: ${{ secrets.AUTH_TOKEN}}
      USER_ID: ${{ secrets.USER_ID}}
      ROOM_ID: ${{ secrets.ROOM_ID}}
      CHAT_ROOM_ID: ${{ secrets.CHAT_ROOM_ID}}
      MESSAGE_ID: ${{ secrets.MESSAGE_ID}}
      GROUP_ID: ${{ secrets.GROUP_ID}}

    steps:
      - uses: actions/checkout@v2

      - name: â„¹ Dart Runtime info
        run: dart --version && dart --help

      - name: ðŸ”§Install dependencies
        run: dart pub get || pub get

      - name: ðŸ”¬Analyze Package
        run: dart analyze

      - name: ðŸ§ªRun Tests
        run: ls && dart run test -h && dart run test . || dart run test ./test/ || dart pub run test
